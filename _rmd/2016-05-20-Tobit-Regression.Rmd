---
layout: post
title: Tobit regression for left censoring data
status: process
published: false
---

## Data with under detection limit

Approaches to analyse data with under detection limit are summarised in [http://www.ats.ucla.edu/stat/r/dae/tobit.htm][1].

One of the approaches is to treat them as left censoring data. To analyse left censoring data, one can use Tobit model.

## Fit tobit regression in R

In R, one can fit a tobit regression model using:

    * vglm (package VGAM): [https://cran.r-project.org/web/packages/VGAM/index.html][2]
    * zelig (package Zelig): [http://docs.zeligproject.org/en/latest/zelig-tobit.html][3] 
    * survreg (package survival): [https://cran.r-project.org/web/packages/survival/index.html][4]

### An example
```{r}
library(survival)
data(tobin)
dat <- transform(tobin, group = rep(1:2, each = nrow(tobin)/2))
```

### Fit tobit model with vglm

* Source: [http://www.ats.ucla.edu/stat/r/dae/tobit.htm][1]

* Model without clustering

```{r}
library(VGAM)
fit1 <- vglm(durable ~ age + quant, tobit(Lower = 0), data = dat)
summary(fit1)
```

### Fit tobit model with zelig

* Source: [http://stackoverflow.com/questions/21608561/how-to-use-robust-se-and-cluster-se-with-vglm-tobit-model][5]

* Model without clustering

```{r}
library(Zelig)
fit2 <- zelig(durable ~ age + quant, below = 0, above = Inf, model = "tobit", data = dat)
summary(fit2)
```

* Model with clustering

```{r}
fit22 <- zelig(durable ~ age + quant, below = 0, above = Inf, model = "tobit", data = dat, robust = TRUE, cluster = "group")
summary(fit22)
```

### Fit tobit model with survreg

* Model without clustering

```{r}
fit3 <- survreg(Surv(durable, I(durable > 0), type = 'left') ~ age + quant, data=dat, dist='gaussian')
summary(fit3)
```

* Model with clustering

```{r}
fit32 <- survreg(Surv(durable, I(durable > 0), type = 'left') ~ age + quant + cluster(group), data=dat, dist='gaussian', robust = TRUE)
summary(fit32)
```

### Comparing results

```{r}
all <- cbind(summary(fit1)@coef3[3:4, 1:2],
             cbind(coef(fit2)[[1]][2:3], sqrt(diag(fit2$getvcov()[[1]]))[2:3]),
             cbind(coef(fit3)[2:3], sqrt(diag(fit3$var))[2:3]),
             cbind(coef(fit32)[2:3], sqrt(diag(fit32$var))[2:3]))
library(knitr)
kable(round(all, 3))
```


[1]: http://www.ats.ucla.edu/stat/r/dae/tobit.htm
[2]: https://cran.r-project.org/web/packages/VGAM/index.html
[3]: http://docs.zeligproject.org/en/latest/zelig-tobit.html
[4]: https://cran.r-project.org/web/packages/survival/index.html
[5]: http://stackoverflow.com/questions/21608561/how-to-use-robust-se-and-cluster-se-with-vglm-tobit-model
