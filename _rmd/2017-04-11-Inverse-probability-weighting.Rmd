---
layout: post
title: Inverse probability weighting
status: wait
published: false
---

```{r}
## create the data set
my.data <- data.frame(AIDS = c(100, 10, 40, 40), 
                      no.AIDS = c(50, 20, 10, 60), 
                      AZT = factor(c("yes", "yes", "no", "no")),
                      low.CD4 = factor(c("yes", "no", "yes", "no")))
## add the weights
my.data$weights <- c(0.75, 30/130, 0.25, 100/130)
my.data$n <- my.data$AIDS + my.data$no.AIDS
my.data

with(my.data, weights * n)
## fit a regression model, using the weights argument
fit.RR.w <- glm(matrix(c(AIDS, no.AIDS), ncol = 2) ~ AZT, data = my.data,
                family = binomial(link="log"), weights = 1/weights)
## we obtain the relative risks via
exp(coef(fit.RR.w))
```

